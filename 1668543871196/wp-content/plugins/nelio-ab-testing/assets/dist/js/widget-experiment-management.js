!function(){var e={n:function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,{a:n}),n},d:function(t,n){for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};!function(){"use strict";e.r(t);var n={};e.r(n),e.d(n,{initAlternativeEdition:function(){return _},initControlEdition:function(){return E}});var i={};e.r(i),e.d(i,{initAlternativeEdition:function(){return P},initControlEdition:function(){return O}});var r,o=window.wp.element,a=window.wp.data,l=window.wp.blockEditor,c=window.nab.utils,u=window.lodash,d=function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},s=null!==(r=null===l.store||void 0===l.store?void 0:l.store.name)&&void 0!==r?r:"core/block-editor";function f(e){var t=document.getElementById("nab-widget-global-style");if(t){var n=e.reduce((function(e,t){return"".concat(e,"\n#block-").concat(t," { display: none; }")}),"");t.textContent=n}}function m(e){var t=e.attributes.id;return"string"==typeof t&&t.startsWith("nab_alt_sidebar")}var p=window.wp.apiFetch,b=e.n(p),w=window.wp.components,g=window.wp.i18n,v=window.wp.url,y=window.nab.components,h=function(e){var t=e.experiment,n=e.alternative,i=(0,o.useState)(!1),r=i[0],a=i[1],l=(0,o.useState)(!1),c=l[0],u=l[1],d=r?(0,g._x)("Duplicating…","text (widgets)","nelio-ab-testing"):(0,g._x)("Duplicate","command","nelio-ab-testing");return o.createElement(o.Fragment,null,o.createElement(w.Button,{isSecondary:!0,onClick:function(){return u(!0)}},(0,g._x)("Duplicate Control Widgets","command","nelio-ab-testing")),o.createElement(y.ConfirmationDialog,{title:(0,g._x)("Duplicate Control Widgets?","title","nelio-ab-testing"),text:(0,g._x)("This will overwrite any widgets you may have in this variant with those included in your theme. Are you sure you want to continue?","user","nelio-ab-testing"),confirmLabel:d,isConfirmEnabled:!r,isCancelEnabled:!r,isDismissible:!r,isOpen:c,onCancel:function(){return u(!1)},onConfirm:function(){r||(a(!0),b()({path:(0,v.addQueryArgs)("/nab/v1/widget/duplicate-control",{experiment:t,alternative:n}),method:"PUT"}).finally((function(){return window.location.reload()})))}}))};function E(){var e,t;e=[],t=(0,u.debounce)((function(){var t=(0,a.select)(s).getBlocks().filter((function(e){return"core/widget-area"===e.name})),n=t.map((function(e){return e.clientId}));if(!(0,c.areEqual)(e,n)){e=n;var i=t.filter(m).map((function(e){return e.clientId}));f(i)}}),100),(0,a.subscribe)(t),t()}function _(e){!function(e){e=d(d([],e,!0),["wp_inactive_widgets"],!1);var t=[],n=(0,u.debounce)((function(){var n=(0,a.select)(s).getBlocks().filter((function(e){return"core/widget-area"===e.name})),i=n.map((function(e){return e.clientId}));if(!(0,c.areEqual)(t,i)){t=i;var r=n.filter((function(t){var n=t.attributes.id;return!e.includes(n)})).map((function(e){return e.clientId}));f(r)}}),100);(0,a.subscribe)(n),n()}(e.sidebars),function(e){var t=0,n=function(){var i,r=document.querySelector(".edit-widgets-header__actions");if(!(null===(i=null==r?void 0:r.children)||void 0===i?void 0:i.length))return t<40&&setTimeout(n,250*++t);r&&function(t){var n=document.createElement("div");t.insertBefore(n,t.children[0]),(0,o.render)(o.createElement(h,{experiment:e.experiment,alternative:e.alternative}),n)}(r)};n()}(e)}var x=window.nab.data;function C(){return Array.from(document.querySelectorAll("div[id^=nab_alt_sidebar_]"))}function A(){C().forEach((function(e){return function(e){var t=function(e){var t=e.replace(/^nab_alt_sidebar_[0-9]+_([^-]+-){4}[^-]+_/,"");return t===e?"":t}(e.getAttribute("id")||"");if(t){var n=document.getElementById(t);n&&e.parentElement&&n.parentElement&&(0,c.appendSibling)(e.parentElement,n.parentElement)}}(e)}))}var S=function(e){var t=e.experiment,n=e.alternative,i=D(),r=i[0],a=i[1],l=k(t,n),c=l[0],u=l[1];return o.createElement("span",null,o.createElement(w.Button,{className:"page-title-action",onClick:function(){return a(!0)},style:{height:"auto"}},(0,g._x)("Duplicate Control Widgets","command","nelio-ab-testing")),o.createElement(y.ConfirmationDialog,{title:(0,g._x)("Duplicate Control Widgets?","title","nelio-ab-testing"),text:(0,g._x)("This will overwrite any widgets you may have in this variant with those included in your theme. Are you sure you want to continue?","user","nelio-ab-testing"),confirmLabel:c?(0,g._x)("Duplicating…","text (widgets)","nelio-ab-testing"):(0,g._x)("Duplicate","command","nelio-ab-testing"),isConfirmEnabled:!c,isCancelEnabled:!c,isOpen:r,onCancel:function(){return a(!1)},onConfirm:u}))},D=function(){return(0,x.usePageAttribute)("widgets/isConfirmationDialogForWidgetDuplicationVisible",!1)},k=function(e,t){var n=(0,x.usePageAttribute)("widgets/isDuplicatingWidgets",!1),i=n[0],r=n[1];return(0,o.useEffect)((function(){i&&b()({path:(0,v.addQueryArgs)("/nab/v1/widget/duplicate-control",{experiment:e,alternative:t}),method:"PUT"}).finally((function(){window.location.reload()}))}),[i]),[i,function(){return r(!0)}]};function O(){A(),C().forEach((function(e){e.parentElement&&(e.parentElement.style.display="none")}))}function P(e){var t;A(),Array.from(document.querySelectorAll(".sidebars-column-1 > .widgets-holder-wrap, .sidebars-column-2 > .widgets-holder-wrap")).forEach((function(e){return e.style.display="none"})),(0,u.filter)(e.sidebars.map((function(e){return document.getElementById(e)})),(function(e){return!!e})).forEach((function(e){e.parentElement&&(e.parentElement.style.display="block")})),(t=document.querySelector("#wpbody-content .wrap .wp-heading-inline"))&&(t.textContent=(0,g._x)("Widget Variant","text","nelio-ab-testing")),Array.from(document.querySelectorAll(".page-title-action")).forEach((function(e){return e.remove()})),function(e){var t=document.querySelector("#wpbody-content .wrap .wp-heading-inline"),n=document.createElement("div");(0,o.render)(o.createElement(S,{experiment:e.experiment,alternative:e.alternative}),n);var i=n.children[0],r=document.createElement("a");r.className="page-title-action",r.textContent=(0,g._x)("Back to Test","command","nelio-ab-testing"),r.setAttribute("href",e.links.experimentUrl),t&&((0,c.appendSibling)(r,t),i&&(0,c.appendSibling)(i,t))}(e)}var B,j=function(){return j=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},j.apply(this,arguments)};window.nab=j(j({},(B=window)&&"object"==typeof B&&"nab"in B?window.nab:{}),{widgets:{blocks:n,classic:i}})}();var n=nab="undefined"==typeof nab?{}:nab;for(var i in t)n[i]=t[i];t.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})}();