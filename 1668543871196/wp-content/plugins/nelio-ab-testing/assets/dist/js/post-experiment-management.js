!function(){var e={n:function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,{a:t}),t},d:function(n,t){for(var i in t)e.o(t,i)&&!e.o(n,i)&&Object.defineProperty(n,i,{enumerable:!0,get:t[i]})},o:function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r:function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},n={};!function(){"use strict";e.r(n);var t,i,r,a=window.nab.data,o=window.wp.element,l=window.nab.experimentLibrary,c=window.wp.apiFetch,s=e.n(c),u=window.wp.components,d=window.wp.data,m=window.wp.i18n,p=window.lodash,b=window.nab.components,f=window.nab.experiments,E=function(){return E=Object.assign||function(e){for(var n,t=1,i=arguments.length;t<i;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},E.apply(this,arguments)},g=function(e){var n=e.experimentId,t=e.postBeingEdited,i=e.type,r=h(n);return r?o.createElement(o.Fragment,null,o.createElement(v,{icon:r,experimentId:n}),o.createElement(x,{experimentId:n,postBeingEdited:t}),o.createElement(_,{postBeingEdited:t,type:i})):null},v=function(e){var n=e.icon,t=e.experimentId,i=w(t),r=y(t);return o.createElement(u.PanelRow,{className:"nab-test-panel"},o.createElement("span",{className:"nab-test-panel__icon"},o.createElement(n,null)),o.createElement("a",{className:"nab-test-panel__name",href:r},i))},x=function(e){var n=e.experimentId,t=e.postBeingEdited,i=I(n);return i?o.createElement(u.PanelRow,{className:"nab-variants-panel"},o.createElement("h2",{className:"nab-variants-panel__title"},(0,m._x)("Variants","text","nelio-ab-testing")),i.map((function(e){var n=e.name,i=e.link,r=e.postId,a=e.index;return o.createElement("div",{className:"nab-alternative",key:r},o.createElement("span",{className:"nab-alternative__letter"},B(a)),o.createElement("span",{className:"nab-alternative__name"},t!==r?o.createElement("a",{href:i},O(n,a)):o.createElement("strong",null,O(n,a))))}))):null},_=function(e){var n=e.postBeingEdited,t=e.type,i=N(n),r=i[0],a=i[1],l=(0,o.useState)(P),c=l[0],s=l[1],d=function(e){return s(E(E({},c),e))},p=c.isImportEnabled,f=c.isConfirmationDialogVisible,g=c.postIdToImportFrom,v=function(){return d({isImportEnabled:!p})},x=function(){return d({isConfirmationDialogVisible:!f})},_=r?(0,m._x)("Importingâ€¦","text","nelio-ab-testing"):(0,m._x)("Import","command","nelio-ab-testing");return o.createElement(u.PanelRow,{className:"nab-content-panel"},o.createElement("h2",{className:"nab-content-panel__title"},(0,m._x)("Content","text","nelio-ab-testing")),o.createElement("span",{className:"nab-content-panel__label"},o.createElement(u.Dashicon,{icon:"admin-page"}),p?(0,m._x)("Import content from:","text","nelio-ab-testing"):o.createElement(u.Button,{isLink:!0,onClick:v},(0,m._x)("Import Content","command","nelio-ab-testing"))),p&&o.createElement(o.Fragment,null,o.createElement(b.PostSearcher,{value:g,className:"nab-content-panel__searcher",type:t,onChange:function(e){return d({postIdToImportFrom:e})}}),o.createElement("div",{className:"nab-content-panel__actions"},o.createElement(u.Button,{isLink:!0,onClick:v},(0,m._x)("Cancel","command","nelio-ab-testing")),o.createElement(u.Button,{isSecondary:!0,disabled:!g,onClick:x},(0,m._x)("Import","command","nelio-ab-testing")),o.createElement(b.ConfirmationDialog,{title:(0,m._x)("Import Content?","text","nelio-ab-testing"),text:(0,m._x)("This will overwrite the current content.","text","nelio-ab-testing"),confirmLabel:_,isConfirmEnabled:!r,isCancelEnabled:!r,isOpen:f,onCancel:x,onConfirm:function(){return a(g)}}))))},w=function(e){return(0,d.useSelect)((function(n){var t;return(null===(t=n(a.STORE_NAME).getExperiment(e))||void 0===t?void 0:t.name)||(0,m._x)("Unnamed Test","text","nelio-ab-testing")}))},y=function(e){return(0,d.useSelect)((function(n){var t;return(null===(t=n(a.STORE_NAME).getExperiment(e))||void 0===t?void 0:t.links.edit)||""}))},I=function(e){return(0,d.useSelect)((function(n){var t;return(0,p.map)(null===(t=n(a.STORE_NAME).getExperiment(e))||void 0===t?void 0:t.alternatives,(function(e,n){return{index:n,postId:C(e)?e.attributes.postId:0,name:S(e)?e.attributes.name:"",link:e.links.edit}}))}))},h=function(e){return(0,d.useSelect)((function(n){var t,i,r,l,c=n(a.STORE_NAME).getExperiment,s=n(f.STORE_NAME).getExperimentTypes,u=null!==(i=null===(t=c(e))||void 0===t?void 0:t.type)&&void 0!==i?i:"";return null!==(l=null===(r=s()[u])||void 0===r?void 0:r.icon)&&void 0!==l?l:function(){return o.createElement(o.Fragment,null)}}))},N=function(e){var n=(0,o.useState)(0),t=n[0],i=n[1];return(0,o.useEffect)((function(){t&&s()({path:"/nab/v1/post/".concat(t,"/overwrites/").concat(e),method:"PUT"}).finally((function(){window.location.reload()}))}),[t]),[!!t,i]},C=function(e){return!!e.attributes.postId},S=function(e){return!!e.attributes.name},B=function(e){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";return e>=n.length?"".concat(e-n.length+1):n.charAt(e)},O=function(e,n){return e||(0===n?(0,m._x)("Control Version","text","nelio-ab-testing"):(0,m.sprintf)(
/* translators: a letter, such as A, B, or C */
(0,m._x)("Variant %s","text","nelio-ab-testing"),B(n)))},P={isImportEnabled:!1,isConfirmationDialogVisible:!1,postIdToImportFrom:0},T=window.wp.plugins,M=null===(i=null===(t=window.wp)||void 0===t?void 0:t.editPost)||void 0===i?void 0:i.PluginDocumentSettingPanel,k=M?function(e){var n=e.experimentId,t=e.postBeingEdited,i=e.type;return o.createElement(M,{className:"nab-alternative-editing-sidebar",title:(0,m._x)("Nelio A/B Testing","text","nelio-ab-testing"),icon:"none"},o.createElement(g,{experimentId:n,postBeingEdited:t,type:i}))}:function(){return null},j=function(){return j=Object.assign||function(e){for(var n,t=1,i=arguments.length;t<i;t++)for(var r in n=arguments[t])Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},j.apply(this,arguments)};window.nab=j(j({},(r=window)&&"object"==typeof r&&"nab"in r?window.nab:{}),{initEditPostAlternativeMetabox:function(e){(0,l.registerCoreExperiments)();var n=e.experimentId,t=e.postBeingEdited,i=e.type,r=document.getElementById("nelioab_edit_post_alternative_box"),a=null==r?void 0:r.getElementsByClassName("inside")[0];a&&(0,o.render)(o.createElement(g,{experimentId:n,postBeingEdited:t,type:i}),a)},initEditPostAlternativeBlockEditorSidebar:function(e){(0,l.registerCoreExperiments)();var n=e.experimentId,t=e.postBeingEdited,i=e.type;(0,T.registerPlugin)("nelio-ab-testing",{icon:function(){return o.createElement(o.Fragment,null)},render:function(){return o.createElement(k,{experimentId:n,postBeingEdited:t,type:i})}})}})}();var t=nab="undefined"==typeof nab?{}:nab;for(var i in n)t[i]=n[i];n.__esModule&&Object.defineProperty(t,"__esModule",{value:!0})}();