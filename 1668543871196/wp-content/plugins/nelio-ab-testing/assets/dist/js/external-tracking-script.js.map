{"version":3,"file":"js/external-tracking-script.js","mappings":"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","sources":["webpack://nab/./assets/src/public/utils/cookies.ts","webpack://nab/./assets/src/public/utils/dom-ready.ts","webpack://nab/./assets/src/public/utils/participation.ts","webpack://nab/./assets/src/public/utils/url.ts","webpack://nab/webpack/bootstrap","webpack://nab/webpack/runtime/define property getters","webpack://nab/webpack/runtime/hasOwnProperty shorthand","webpack://nab/webpack/runtime/make namespace object","webpack://nab/./assets/src/public/tracking/external/index.ts"],"sourcesContent":["/**\n * External dependencies\n */\nimport type { Maybe } from '@nab/types';\n\ntype CookieOptions = {\n\treadonly path: string;\n\treadonly expires: number;\n};\n\nexport function setCookie(\n\tname: string,\n\tvalue: number | boolean | string,\n\toptions?: Partial< CookieOptions >\n): void {\n\tconst opts: CookieOptions = {\n\t\tpath: '/',\n\t\texpires: 0,\n\t\t...( options || {} ),\n\t};\n\n\tlet cookie = `${ name }=${ encodeURIComponent( value ) };`;\n\n\tif ( 0 < opts.expires ) {\n\t\tconst expiration = new Date(\n\t\t\tnew Date().getTime() + opts.expires * 864e5\n\t\t);\n\t\tcookie += ` expires=${ expiration.toUTCString() };`;\n\t} //end if\n\n\tcookie += ` path=${ opts.path };`;\n\n\tdocument.cookie = cookie;\n} //end setCookie()\n\nexport function getCookie( name: string ): Maybe< string > {\n\tconst cookies = document.cookie\n\t\t.split( ';' )\n\t\t.map( ( cookie ) => cookie.trim() )\n\t\t.reduce( ( memo, cookie ) => {\n\t\t\tmemo[ cookie.split( '=' )[ 0 ] ] = cookie.split( '=' )[ 1 ];\n\t\t\treturn memo;\n\t\t}, {} );\n\n\tif ( ! cookies[ name ] ) {\n\t\treturn;\n\t} //end if\n\treturn decodeURIComponent( cookies[ name ] );\n} //end getCookie()\n\nexport function removeCookie( name: string ): void {\n\tdocument.cookie = `${ name }=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;\n} //end removeCookie()\n","export default function domReady( callback: () => unknown ): void {\n\tif ( typeof document === 'undefined' ) {\n\t\treturn;\n\t} //end if\n\n\tif (\n\t\tdocument.readyState === 'complete' || // DOMContentLoaded + Images/Styles/etc loaded, so we call directly.\n\t\tdocument.readyState === 'interactive' // DOMContentLoaded fires at this point, so we call directly.\n\t) {\n\t\treturn void callback();\n\t} //end if\n\n\t// DOMContentLoaded has not fired yet, delay callback until then.\n\tdocument.addEventListener( 'DOMContentLoaded', callback );\n} //end domReady()\n","/**\n * Internal dependencies\n */\nimport { getCookie, removeCookie, setCookie } from '../utils/cookies';\nimport type { Settings } from '../alternative-loader/types';\n\ntype ParticipationSettings = Pick<\n\tSettings,\n\t'gdprCookie' | 'participationChance'\n>;\n\nexport function isIE(): boolean {\n\tconst ua = window.navigator.userAgent || '';\n\treturn -1 !== ua.indexOf( 'MSIE ' ) || -1 !== ua.indexOf( 'Trident/' );\n} //end isIE()\n\nexport function doesVisitorParticipate(\n\tsettings: ParticipationSettings\n): boolean {\n\tif ( ! settings ) {\n\t\treturn false;\n\t} //end if\n\n\tif ( isIE() ) {\n\t\treturn false;\n\t} //end if\n\n\tif ( ! areCookiesEnabled() ) {\n\t\treturn false;\n\t} //end if\n\n\tconst { gdprCookie } = settings;\n\tif ( ! isGdprAccepted( gdprCookie ) ) {\n\t\treturn false;\n\t} //end if\n\n\tif ( isVisitorExcludedFromTesting() ) {\n\t\treturn false;\n\t} //end if\n\n\tconst { participationChance } = settings;\n\treturn doesVisitorParticipateAccordingToTheCookie( participationChance );\n} //end doesVisitorParticipate()\n\nexport function isVisitorExcludedFromTesting(): boolean {\n\treturn !! getCookie( 'nabIsVisitorExcluded' );\n} //end isVisitorExcludedFromTesting()\n\n// =======\n// HELPERS\n// =======\n\nfunction areCookiesEnabled() {\n\tsetCookie( 'nabCheckWritePermission', true );\n\tif ( ! getCookie( 'nabCheckWritePermission' ) ) {\n\t\treturn false;\n\t} //end if\n\n\tremoveCookie( 'nabCheckWritePermission' );\n\treturn true;\n} //end areCookiesEnable();\n\nfunction isGdprAccepted( gdprCookie: string | false ) {\n\tif ( ! gdprCookie ) {\n\t\treturn true;\n\t} //end if\n\n\treturn !! getCookie( gdprCookie );\n} //end isGdprAccepted()\n\nfunction doesVisitorParticipateAccordingToTheCookie(\n\tparticipationChance: number\n) {\n\tif (\n\t\t! isVisitorParticipationCookieValid() ||\n\t\tshouldVisitorParticipationCookieBeUpdated( participationChance )\n\t) {\n\t\tgenerateVisitorParticipationCookie( participationChance );\n\t} //end if\n\n\tconst participation = getCookie( 'nabParticipation' );\n\treturn 0 === participation?.indexOf( 'true' );\n} //end doesVisitorParticipateAccordingToTheCookie()\n\nfunction isVisitorParticipationCookieValid() {\n\tconst participation = getCookie( 'nabParticipation' ) || '';\n\treturn /^(true|false),[0-9]{1,3}$/.test( participation );\n} //end isVisitorParticipationCookieValid()\n\nfunction shouldVisitorParticipationCookieBeUpdated(\n\tparticipationChance: number\n) {\n\tconst participation = getCookie( 'nabParticipation' ) || '';\n\treturn participation.split( ',' )[ 1 ] !== `${ participationChance }`;\n} //end shouldVisitorParticipationCookieBeUpdated()\n\nfunction generateVisitorParticipationCookie( participationChance: number ) {\n\tconst random = Math.min( 100, Math.floor( Math.random() * 101 ) );\n\tconst shouldVisitorParticipate =\n\t\trandom <= participationChance ? 'true' : 'false';\n\tsetCookie(\n\t\t'nabParticipation',\n\t\t`${ shouldVisitorParticipate },${ participationChance }`,\n\t\t{ expires: 120 }\n\t);\n} //end generateVisitorParticipationCookie()\n","type ParamValue = string | number | boolean;\n\nexport function buildUrl(\n\turl: string,\n\targs: Record< string, ParamValue > = {},\n\thash?: string\n): string {\n\tconst keys = Object.keys( args );\n\tif ( keys.length ) {\n\t\turl +=\n\t\t\t'?' +\n\t\t\tkeys\n\t\t\t\t.map(\n\t\t\t\t\t( key ) => `${ key }=${ encodeURIComponent( args[ key ] ) }`\n\t\t\t\t)\n\t\t\t\t.map( ( arg ) =>\n\t\t\t\t\t/=$/.test( arg ) ? arg.slice( 0, -1 ) : arg\n\t\t\t\t)\n\t\t\t\t.reduce( ( search, pair ) => `${ search }&${ pair }` );\n\t} //end if\n\n\tif ( hash ) {\n\t\turl += '#' + hash;\n\t} //end if\n\n\treturn url;\n} //end buildUrl()\n\nexport function removeArgsAndHash( url: string ): string {\n\tconst { cleanUrl } = fragments( url );\n\treturn cleanUrl;\n} //end removeArgsAndHash()\n\nexport function getHash( url: string ): string {\n\tconst { hash } = fragments( url );\n\treturn hash;\n} //end getHash()\n\nexport function addQueryArgs(\n\turl: string,\n\targs?: Record< string, ParamValue >\n): string {\n\targs = args ?? {};\n\tconst { cleanUrl, hash } = fragments( url );\n\n\tconst newArgs = {\n\t\t...getQueryArgs( url ),\n\t\t...args,\n\t};\n\treturn buildUrl( cleanUrl, newArgs, hash );\n} //end addQueryArgs()\n\nexport function removeQueryArgs(\n\turl: string,\n\t...names: ReadonlyArray< string >\n): string {\n\turl = url || '';\n\n\tif ( 0 === names.length ) {\n\t\treturn url;\n\t} //end if\n\n\tconst { cleanUrl, hash } = fragments( url );\n\n\tconst args = getQueryArgs( url );\n\tfor ( const key of names ) {\n\t\tdelete args[ key ];\n\t} //end for\n\n\treturn buildUrl( cleanUrl, args, hash );\n} //end removeQueryArgs()\n\nexport function getQueryArgs( url: string ): Record< string, string > {\n\tconst { search } = fragments( url );\n\tif ( ! search ) {\n\t\treturn {};\n\t} //end if\n\tconst args = search.split( '&' );\n\treturn args.reduce( ( res, arg ) => {\n\t\tconst [ key, value = '' ] = arg.split( '=' );\n\t\tif ( key ) {\n\t\t\tres[ key ] = decodeURIComponent( value );\n\t\t} //end if\n\t\treturn res;\n\t}, {} );\n} //end getQueryArgs()\n\n// =======\n// HELPERS\n// =======\n\nfunction fragments( url: string ) {\n\tconst baseUrl =\n\t\t0 <= url.indexOf( '#' ) ? url.substr( 0, url.indexOf( '#' ) ) : url;\n\tconst hash =\n\t\t0 <= url.indexOf( '#' ) ? url.substr( url.indexOf( '#' ) + 1 ) : '';\n\n\tconst cleanUrl =\n\t\t0 <= baseUrl.indexOf( '?' )\n\t\t\t? baseUrl.substr( 0, baseUrl.indexOf( '?' ) )\n\t\t\t: baseUrl;\n\n\tconst search =\n\t\t0 <= baseUrl.indexOf( '?' )\n\t\t\t? baseUrl.substr( baseUrl.indexOf( '?' ) + 1 )\n\t\t\t: '';\n\n\treturn {\n\t\tcleanUrl,\n\t\tsearch,\n\t\thash,\n\t};\n} //end fragments()\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * Internal dependencies\n */\nimport type { ExperimentId } from '@nab/types';\n\n/**\n * Internal dependencies\n */\nimport domReady from '../../utils/dom-ready';\nimport { isIE } from '../../utils/participation';\nimport { addQueryArgs } from '../../utils/url';\n\ntype Settings = {\n\treadonly trackingFrameUrl: string;\n};\n\nlet settings: Settings;\nlet isDomReady = false;\nexport function init( _settings: Settings ): void {\n\tif ( isIE() ) {\n\t\treturn;\n\t} //end if\n\n\tif ( settings ) {\n\t\t// eslint-disable-next-line\n\t\tconsole.error( 'Init method can only run once.' );\n\t\treturn;\n\t} //end if\n\n\tsettings = _settings;\n\tdomReady( () => {\n\t\tisDomReady = true;\n\t\tsynchPendingStuff();\n\t} );\n} //end if\n\ntype PendingConversion = {\n\treadonly experimentId: ExperimentId;\n\treadonly goalIndex: number;\n};\n\nlet pendingConversions: ReadonlyArray< PendingConversion > = [];\nlet synchedConversions: ReadonlyArray< string > = [];\nexport function convert( experimentId: ExperimentId, goalIndex: number ): void {\n\tif ( isIE() || ! settings ) {\n\t\treturn;\n\t} //end if\n\n\tif ( ! isDomReady ) {\n\t\tpendingConversions = [\n\t\t\t...pendingConversions,\n\t\t\t{ experimentId, goalIndex },\n\t\t];\n\t\treturn;\n\t} //end if\n\n\tif ( synchedConversions.includes( `${ experimentId }-${ goalIndex }` ) ) {\n\t\treturn;\n\t} //end if\n\tsynchedConversions = [\n\t\t...synchedConversions,\n\t\t`${ experimentId }-${ goalIndex }`,\n\t];\n\n\tconst url = addQueryArgs( settings.trackingFrameUrl, {\n\t\texperiment: experimentId,\n\t\tgoal: goalIndex,\n\t} );\n\tload( url );\n} //end convert()\n\nlet pendingEvents: ReadonlyArray< string > = [];\nlet synchedEvents: ReadonlyArray< string > = [];\nexport function trigger( eventName: string ): void {\n\tif ( isIE() || ! settings ) {\n\t\treturn;\n\t} //end if\n\n\tif ( ! isDomReady ) {\n\t\tpendingEvents = [ ...pendingEvents, eventName ];\n\t\treturn;\n\t} //end if\n\n\tif ( synchedEvents.includes( eventName ) ) {\n\t\treturn;\n\t} //end if\n\tsynchedEvents = [ ...synchedEvents, eventName ];\n\n\tconst url = addQueryArgs( settings.trackingFrameUrl, { eventName } );\n\tload( url );\n} //end convert()\n\n// =======\n// HELPERS\n// =======\n\nfunction load( url: string ) {\n\tconst iframe = document.createElement( 'iframe' );\n\tiframe.src = url;\n\tiframe.style.display = 'none';\n\tdocument.body.appendChild( iframe );\n} //end load()\n\nfunction synchPendingStuff() {\n\tpendingConversions.forEach( ( { experimentId, goalIndex } ) =>\n\t\tconvert( experimentId, goalIndex )\n\t);\n\tpendingConversions = [];\n\n\tpendingEvents.forEach( ( eventName ) => trigger( eventName ) );\n\tpendingEvents = [];\n} //end synchPendingStuff()\n"],"names":[],"sourceRoot":""}