!function(){var t={n:function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,{a:n}),n},d:function(e,n){for(var i in n)t.o(n,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r:function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};!function(){"use strict";t.r(e);var n=window.wp.domReady,i=t.n(n),a=window.wp.apiFetch,r=t.n(a),o=window.wp.i18n,s=window.wp.url,l=(window.Node,window.XPathResult);function h(t,e){var n=document.createElement(t);return n.className="nab-overlay-element",n.style.position="absolute",n.style.left="0px",n.style.top="0px",n.style.zIndex="999999",u(n,e),n}function u(t,e){var n=document.body.clientWidth,i=c(e);t.style.width="".concat(n,"px"),t.style.height="".concat(i,"px"),f(t)&&(t.width=n,t.height=i)}function c(t){var e=document.body.clientHeight;switch(t){case"smartphone":return Math.min(e,43200);case"tablet":return Math.min(e,36e3);default:return Math.min(e,3e4)}}function d(t,e){var n=e[t].width,i=Object.values(e).map((function(t){return t.width})),a=i.reduce((function(t,e){return e<n?Math.max(e,t):t}),-1),r=i.reduce((function(t,e){return n<e?Math.min(e,t):t}),Number.POSITIVE_INFINITY);return Number.POSITIVE_INFINITY!==r&&(r=n),{minWidth:a+1,maxWidth:r}}var f=function(t){return"canvas"===t.nodeName.toLowerCase()},g=function(){return g=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},g.apply(this,arguments)},p=function(t,e,n){if(n||2===arguments.length)for(var i,a=0,r=e.length;a<r;a++)!i&&a in e||(i||(i=Array.prototype.slice.call(e,0,a)),i[a]=e[a]);return t.concat(i||Array.prototype.slice.call(e))},b=!1,v=!1,m={desktop:!1,tablet:!1,smartphone:!1},y={desktop:{},tablet:{},smartphone:{}};function x(){return b?[]:v&&m.desktop?v.clicks:[]}function E(t){return!!m[t]}function _(t,e,n,i){var a=i.siteId,r={alternative:n,start:e.startDate,end:null==e?void 0:e.endDate,tz:i.timezone};return new Promise((function(n){w((0,s.addQueryArgs)("https://api.nelioabtesting.com/v1/site/".concat(a,"/experiment/").concat(e.id,"/").concat(t),r),i.awsAuthToken,[],n)}))}function w(t,e,n,i){r()({url:t,method:"GET",credentials:"omit",mode:"cors",headers:{Authorization:"Bearer ".concat(e)}}).then((function(a){var r=a.data,o=a.page;n=p(p([],n,!0),r,!0);var l=(0,s.addQueryArgs)(t,{page:o});o&&t!==l?w(l,e,n,i):i(n)}),(function(){return i(n)}))}function T(t){v&&(v.clicks.forEach((function(e){var n=e.x,i=e.y,a=function(t,e){var n=t.xpath||t.cssPath;if(!n)return!1;if(void 0!==y[e][n])return y[e][n];var i,a,r=null;try{r=t.xpath?(i=n,document.evaluate(i,document,null,l.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue):document.querySelector(n)}catch(e){console.log("OOPS",t.xpath)}return(a=r)&&Node.ELEMENT_NODE===a.nodeType?y[e][n]=r.getBoundingClientRect():y[e][n]=!1,y[e][n]}(e,t)||{top:0,left:0,width:0,height:0},r=a.top,o=a.left,s=a.width,h=a.height,u=o+n*s,c=r+i*h;e.realCoordinates=e.realCoordinates||{},e.realCoordinates[t]=g(g({},e.realCoordinates[t]||{}),{x:u,y:c}),e.isVisibleInResolution=e.isVisibleInResolution||{},e.isVisibleInResolution[t]=s>0&&h>0})),m[t]=!0)}function A(t){"string"==typeof t&&(t=Number.parseInt(t));for(var e=[2,3,4,5,10,15,20,25,30,60,120,180,300],n=0;n<e.length;++n)if(t<=e[n])return"".concat(n);return"".concat(e[e.length-1])}function R(t){"string"==typeof t&&(t=Number.parseInt(t));for(var e=[300,600,900,1200,1500,1800,2100],n=0;n<e.length;++n)if(t<e[n])return"".concat(n);return"".concat(e[e.length-1])}var F="nab/data",S={original:!1},O={desktop:!1,smartphone:!1,tablet:!1};var C,I,P,k,M,L,B,N,W,D,U,G,H,X=!1,z=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};N=function(){var t,e,n,i,a,r,o,s,l,h,u,c,d,f;if((a=function(){var t,e,n;return(t=document.createElement("canvas")).width=2,t.height=2,(n=(e=t.getContext("2d")).getImageData(0,0,2,2)).data.set(new Uint8ClampedArray([0,0,0,0,255,255,255,255,0,0,0,0,255,255,255,255])),e.putImageData(n,0,0),t})(),e=function(t,e){var n,i,r,o,s,l,h,u,c,d,f,g,p,b;if(l=t.createProgram(),p=t.createShader(t.VERTEX_SHADER),t.attachShader(l,p),t.shaderSource(p,"attribute vec2 position;\nvoid main(){\n    gl_Position = vec4(position, 0.0, 1.0);\n}"),t.compileShader(p),!t.getShaderParameter(p,t.COMPILE_STATUS))throw t.getShaderInfoLog(p);if(r=t.createShader(t.FRAGMENT_SHADER),t.attachShader(l,r),t.shaderSource(r,"uniform sampler2D source;\nvoid main(){\n    gl_FragColor = texture2D(source, vec2(1.0, 1.0));\n}"),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS))throw t.getShaderInfoLog(r);if(t.linkProgram(l),!t.getProgramParameter(l,t.LINK_STATUS))throw t.getProgramInfoLog(l);return t.useProgram(l),i=function(){return t.deleteShader(r),t.deleteShader(p),t.deleteProgram(l),t.deleteBuffer(n),t.deleteTexture(c),t.deleteTexture(g),t.deleteFramebuffer(o),t.bindBuffer(t.ARRAY_BUFFER,null),t.useProgram(null),t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null)},g=t.createTexture(),t.bindTexture(t.TEXTURE_2D,g),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,2,2,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),o=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,g,0),d=a(),c=t.createTexture(),t.bindTexture(t.TEXTURE_2D,c),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,e,d),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),b=new Float32Array([1,1,-1,1,-1,-1,1,1,-1,-1,1,-1]),n=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,b,t.STATIC_DRAW),s=t.getAttribLocation(l,"position"),f=t.getUniformLocation(l,"source"),t.enableVertexAttribArray(s),t.vertexAttribPointer(s,2,t.FLOAT,!1,0,0),t.uniform1i(f,0),t.drawArrays(t.TRIANGLES,0,6),h=new Uint8Array(16),t.readPixels(0,0,2,2,t.RGBA,t.UNSIGNED_BYTE,h),u=Math.abs(h[0]-127)<10,i(),u},i=function(t,e){var n;return n=t.createTexture(),t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,2,2,0,t.RGBA,e,null),0===t.getError()?(t.deleteTexture(n),!0):(t.deleteTexture(n),!1)},t=function(t,e){var n,i,a;return a=t.createTexture(),t.bindTexture(t.TEXTURE_2D,a),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,2,2,0,t.RGBA,e,null),i=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,a,0),n=t.checkFramebufferStatus(t.FRAMEBUFFER),t.deleteTexture(a),t.deleteFramebuffer(i),t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),n===t.FRAMEBUFFER_COMPLETE},l=[],h={},u=[],n=function(){var n,a,r,o,s;n=document.createElement("canvas"),a=null;try{null===(a=n.getContext("experimental-webgl"))&&(a=n.getContext("webgl"))}catch(t){}if(null!=a&&(null===a.getExtension("OES_texture_float")?i(a,a.FLOAT)?(s=!0,l.push("OES_texture_float"),h.OES_texture_float={shim:!0}):(s=!1,u.push("OES_texture_float")):i(a,a.FLOAT)?(s=!0,l.push("OES_texture_float")):(s=!1,u.push("OES_texture_float")),s&&(null===a.getExtension("WEBGL_color_buffer_float")?t(a,a.FLOAT)?(l.push("WEBGL_color_buffer_float"),h.WEBGL_color_buffer_float={shim:!0,RGBA32F_EXT:34836,RGB32F_EXT:34837,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,UNSIGNED_NORMALIZED_EXT:35863}):u.push("WEBGL_color_buffer_float"):t(a,a.FLOAT)?l.push("WEBGL_color_buffer_float"):u.push("WEBGL_color_buffer_float"),null===a.getExtension("OES_texture_float_linear")?e(a,a.FLOAT)?(l.push("OES_texture_float_linear"),h.OES_texture_float_linear={shim:!0}):u.push("OES_texture_float_linear"):e(a,a.FLOAT)?l.push("OES_texture_float_linear"):u.push("OES_texture_float_linear")),null===(r=a.getExtension("OES_texture_half_float"))?i(a,36193)?(o=!0,l.push("OES_texture_half_float"),r=h.OES_texture_half_float={HALF_FLOAT_OES:36193,shim:!0}):(o=!1,u.push("OES_texture_half_float")):i(a,r.HALF_FLOAT_OES)?(o=!0,l.push("OES_texture_half_float")):(o=!1,u.push("OES_texture_half_float")),o))return null===a.getExtension("EXT_color_buffer_half_float")?t(a,r.HALF_FLOAT_OES)?(l.push("EXT_color_buffer_half_float"),h.EXT_color_buffer_half_float={shim:!0,RGBA16F_EXT:34842,RGB16F_EXT:34843,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,UNSIGNED_NORMALIZED_EXT:35863}):u.push("EXT_color_buffer_half_float"):t(a,r.HALF_FLOAT_OES)?l.push("EXT_color_buffer_half_float"):u.push("EXT_color_buffer_half_float"),null===a.getExtension("OES_texture_half_float_linear")?e(a,r.HALF_FLOAT_OES)?(l.push("OES_texture_half_float_linear"),h.OES_texture_half_float_linear={shim:!0}):u.push("OES_texture_half_float_linear"):e(a,r.HALF_FLOAT_OES)?l.push("OES_texture_half_float_linear"):u.push("OES_texture_half_float_linear")},null!=window.WebGLRenderingContext){for(n(),c={},d=0,f=u.length;d<f;d++)s=u[d],c[s]=!0;return r=WebGLRenderingContext.prototype.getExtension,WebGLRenderingContext.prototype.getExtension=function(t){var e;return void 0===(e=h[t])?c[t]?null:r.call(this,t):e},o=WebGLRenderingContext.prototype.getSupportedExtensions,WebGLRenderingContext.prototype.getSupportedExtensions=function(){var t,e,n,i,a,r,s;for(e=[],i=0,r=(n=o.call(this)).length;i<r;i++)t=n[i],void 0===c[t]&&e.push(t);for(a=0,s=l.length;a<s;a++)t=l[a],z.call(e,t)<0&&e.push(t);return e},WebGLRenderingContext.prototype.getFloatExtension=function(t){var e,n,i,a,r,o,l,h,u,c,d,f,g,p,b,v,m,y,x,E,_,w,T,A,R,F;for(null==t.prefer&&(t.prefer=["half"]),null==t.require&&(t.require=[]),null==t.throws&&(t.throws=!0),p=this.getExtension("OES_texture_float"),o=this.getExtension("OES_texture_half_float"),f=this.getExtension("WEBGL_color_buffer_float"),a=this.getExtension("EXT_color_buffer_half_float"),g=this.getExtension("OES_texture_float_linear"),r=this.getExtension("OES_texture_half_float_linear"),d={texture:null!==p,filterable:null!==g,renderable:null!==f,score:0,precision:"single",half:!1,single:!0,type:this.FLOAT},i={texture:null!==o,filterable:null!==r,renderable:null!==a,score:0,precision:"half",half:!0,single:!1,type:null!=(A=null!=o?o.HALF_FLOAT_OES:void 0)?A:null},n=[],d.texture&&n.push(d),i.texture&&n.push(i),c=[],v=0,x=n.length;v<x;v++){for(e=n[v],b=!0,m=0,E=(R=t.require).length;m<E;m++)!1===e[s=R[m]]&&(b=!1);b&&c.push(e)}for(y=0,_=c.length;y<_;y++)for(e=c[y],l=T=0,w=(F=t.prefer).length;T<w;l=++T)u=F[l],h=Math.pow(2,t.prefer.length-l-1),e[u]&&(e.score+=h);if(c.sort((function(t,e){return t.score===e.score?0:t.score<e.score?1:t.score>e.score?-1:void 0})),0===c.length){if(t.throws)throw"No floating point texture support that is "+t.require.join(", ");return null}return{filterable:(c=c[0]).filterable,renderable:c.renderable,type:c.type,precision:c.precision}}}},null!=window.WebGLRenderingContext&&(H=["WEBKIT","MOZ","MS","O"],G=/^WEBKIT_(.*)|MOZ_(.*)|MS_(.*)|O_(.*)/,D=WebGLRenderingContext.prototype.getExtension,WebGLRenderingContext.prototype.getExtension=function(t){var e,n,i,a,r;if(null!==(n=t.match(G))&&(t=n[1]),null===(e=D.call(this,t))){for(a=0,r=H.length;a<r;a++)if(i=H[a],null!==(e=D.call(this,i+"_"+t)))return e;return null}return e},U=WebGLRenderingContext.prototype.getSupportedExtensions,WebGLRenderingContext.prototype.getSupportedExtensions=function(){var t,e,n,i,a,r;for(n=[],a=0,r=(i=U.call(this)).length;a<r;a++)null!==(e=(t=i[a]).match(G))&&(t=e[1]),z.call(n,t)<0&&n.push(t);return n}),N(),k=function(){function t(t,e){var n,i;this.gl=t,i=e.vertex,n=e.fragment,this.program=this.gl.createProgram(),this.vs=this.gl.createShader(this.gl.VERTEX_SHADER),this.fs=this.gl.createShader(this.gl.FRAGMENT_SHADER),this.gl.attachShader(this.program,this.vs),this.gl.attachShader(this.program,this.fs),this.compileShader(this.vs,i),this.compileShader(this.fs,n),this.link(),this.value_cache={},this.uniform_cache={},this.attribCache={}}return t.prototype.attribLocation=function(t){var e;return void 0===(e=this.attribCache[t])&&(e=this.attribCache[t]=this.gl.getAttribLocation(this.program,t)),e},t.prototype.compileShader=function(t,e){if(this.gl.shaderSource(t,e),this.gl.compileShader(t),!this.gl.getShaderParameter(t,this.gl.COMPILE_STATUS))throw"Shader Compile Error: "+this.gl.getShaderInfoLog(t)},t.prototype.link=function(){if(this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))throw"Shader Link Error: "+this.gl.getProgramInfoLog(this.program)},t.prototype.use=function(){return this.gl.useProgram(this.program),this},t.prototype.uniformLoc=function(t){var e;return void 0===(e=this.uniform_cache[t])&&(e=this.uniform_cache[t]=this.gl.getUniformLocation(this.program,t)),e},t.prototype.int=function(t,e){var n;return this.value_cache[t]!==e&&(this.value_cache[t]=e,(n=this.uniformLoc(t))&&this.gl.uniform1i(n,e)),this},t.prototype.vec2=function(t,e,n){var i;return(i=this.uniformLoc(t))&&this.gl.uniform2f(i,e,n),this},t.prototype.float=function(t,e){var n;return this.value_cache[t]!==e&&(this.value_cache[t]=e,(n=this.uniformLoc(t))&&this.gl.uniform1f(n,e)),this},t}(),C=function(){function t(t){this.gl=t,this.buffer=this.gl.createFramebuffer()}return t.prototype.destroy=function(){return this.gl.deleteFRamebuffer(this.buffer)},t.prototype.bind=function(){return this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.buffer),this},t.prototype.unbind=function(){return this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this},t.prototype.check=function(){switch(this.gl.checkFramebufferStatus(this.gl.FRAMEBUFFER)){case this.gl.FRAMEBUFFER_UNSUPPORTED:throw"Framebuffer is unsupported";case this.gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:throw"Framebuffer incomplete attachment";case this.gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:throw"Framebuffer incomplete dimensions";case this.gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:throw"Framebuffer incomplete missing attachment"}return this},t.prototype.color=function(t){return this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,t.target,t.handle,0),this.check(),this},t.prototype.depth=function(t){return this.gl.framebufferRenderbuffer(this.gl.FRAMEBUFFER,this.gl.DEPTH_ATTACHMENT,this.gl.RENDERBUFFER,t.id),this.check(),this},t.prototype.destroy=function(){return this.gl.deleteFramebuffer(this.buffer)},t}(),M=function(){function t(t,e){var n,i;switch(this.gl=t,null==e&&(e={}),this.channels=this.gl[(null!=(n=e.channels)?n:"rgba").toUpperCase()],"number"==typeof e.type?this.type=e.type:this.type=this.gl[(null!=(i=e.type)?i:"unsigned_byte").toUpperCase()],this.channels){case this.gl.RGBA:this.chancount=4;break;case this.gl.RGB:this.chancount=3;break;case this.gl.LUMINANCE_ALPHA:this.chancount=2;break;default:this.chancount=1}this.target=this.gl.TEXTURE_2D,this.handle=this.gl.createTexture()}return t.prototype.destroy=function(){return this.gl.deleteTexture(this.handle)},t.prototype.bind=function(t){if(null==t&&(t=0),t>15)throw"Texture unit too large: "+t;return this.gl.activeTexture(this.gl.TEXTURE0+t),this.gl.bindTexture(this.target,this.handle),this},t.prototype.setSize=function(t,e){return this.width=t,this.height=e,this.gl.texImage2D(this.target,0,this.channels,this.width,this.height,0,this.channels,this.type,null),this},t.prototype.upload=function(t){return this.width=t.width,this.height=t.height,this.gl.texImage2D(this.target,0,this.channels,this.channels,this.type,t),this},t.prototype.linear=function(){return this.gl.texParameteri(this.target,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.target,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this},t.prototype.nearest=function(){return this.gl.texParameteri(this.target,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),this.gl.texParameteri(this.target,this.gl.TEXTURE_MIN_FILTER,this.gl.NEAREST),this},t.prototype.clampToEdge=function(){return this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this},t.prototype.repeat=function(){return this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.target,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this},t}(),P=function(){function t(t,e,n){var i;this.gl=t,this.width=e,this.height=n,i=this.gl.getFloatExtension({require:["renderable"]}),this.texture=new M(this.gl,{type:i.type}).bind(0).setSize(this.width,this.height).nearest().clampToEdge(),this.fbo=new C(this.gl).bind().color(this.texture).unbind()}return t.prototype.use=function(){return this.fbo.bind()},t.prototype.bind=function(t){return this.texture.bind(t)},t.prototype.end=function(){return this.fbo.unbind()},t.prototype.resize=function(t,e){return this.width=t,this.height=e,this.texture.bind(0).setSize(this.width,this.height)},t}(),W="attribute vec4 position;\nvarying vec2 texcoord;\nvoid main(){\n    texcoord = position.xy*0.5+0.5;\n    gl_Position = position;\n}",B="#ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp int;\n    precision highp float;\n#else\n    precision mediump int;\n    precision mediump float;\n#endif\nuniform sampler2D source;\nvarying vec2 texcoord;",I=function(){function t(t,e,n,i){var a,r,o;for(this.heatmap=t,this.gl=e,this.width=n,this.height=i,this.shader=new k(this.gl,{vertex:"attribute vec4 position, intensity;\nvarying vec2 off, dim;\nvarying float vIntensity;\nuniform vec2 viewport;\n\nvoid main(){\n    dim = abs(position.zw);\n    off = position.zw;\n    vec2 pos = position.xy + position.zw;\n    vIntensity = intensity.x;\n    gl_Position = vec4((pos/viewport)*2.0-1.0, 0.0, 1.0);\n}",fragment:"#ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp int;\n    precision highp float;\n#else\n    precision mediump int;\n    precision mediump float;\n#endif\nvarying vec2 off, dim;\nvarying float vIntensity;\nvoid main(){\n    float falloff = (1.0 - smoothstep(0.0, 1.0, length(off/dim)));\n    float intensity = falloff*vIntensity;\n    gl_FragColor = vec4(intensity);\n}"}),this.clampShader=new k(this.gl,{vertex:W,fragment:B+"uniform float low, high;\nvoid main(){\n    gl_FragColor = vec4(clamp(texture2D(source, texcoord).rgb, low, high), 1.0);\n}"}),this.multiplyShader=new k(this.gl,{vertex:W,fragment:B+"uniform float value;\nvoid main(){\n    gl_FragColor = vec4(texture2D(source, texcoord).rgb*value, 1.0);\n}"}),this.blurShader=new k(this.gl,{vertex:W,fragment:B+"uniform vec2 viewport;\nvoid main(){\n    vec4 result = vec4(0.0);\n    for(int x=-1; x<=1; x++){\n        for(int y=-1; y<=1; y++){\n            vec2 off = vec2(x,y)/viewport;\n            //float factor = 1.0 - smoothstep(0.0, 1.5, length(off));\n            float factor = 1.0;\n            result += vec4(texture2D(source, texcoord+off).rgb*factor, factor);\n        }\n    }\n    gl_FragColor = vec4(result.rgb/result.w, 1.0);\n}"}),this.nodeBack=new P(this.gl,this.width,this.height),this.nodeFront=new P(this.gl,this.width,this.height),this.vertexBuffer=this.gl.createBuffer(),this.vertexSize=8,this.maxPointCount=10240,this.vertexBufferData=new Float32Array(this.maxPointCount*this.vertexSize*6),this.vertexBufferViews=[],a=r=0,o=this.maxPointCount;0<=o?r<o:r>o;a=0<=o?++r:--r)this.vertexBufferViews.push(new Float32Array(this.vertexBufferData.buffer,0,a*this.vertexSize*6));this.bufferIndex=0,this.pointCount=0}return t.prototype.resize=function(t,e){return this.width=t,this.height=e,this.nodeBack.resize(this.width,this.height),this.nodeFront.resize(this.width,this.height)},t.prototype.update=function(){var t,e;if(this.pointCount>0)return this.gl.enable(this.gl.BLEND),this.nodeFront.use(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertexBufferViews[this.pointCount],this.gl.STREAM_DRAW),e=this.shader.attribLocation("position"),t=this.shader.attribLocation("intensity"),this.gl.enableVertexAttribArray(1),this.gl.vertexAttribPointer(e,4,this.gl.FLOAT,!1,32,0),this.gl.vertexAttribPointer(t,4,this.gl.FLOAT,!1,32,16),this.shader.use().vec2("viewport",this.width,this.height),this.gl.drawArrays(this.gl.TRIANGLES,0,6*this.pointCount),this.gl.disableVertexAttribArray(1),this.pointCount=0,this.bufferIndex=0,this.nodeFront.end(),this.gl.disable(this.gl.BLEND)},t.prototype.clear=function(){return this.nodeFront.use(),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.nodeFront.end()},t.prototype.clamp=function(t,e){return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.heatmap.quad),this.gl.vertexAttribPointer(0,4,this.gl.FLOAT,!1,0,0),this.nodeFront.bind(0),this.nodeBack.use(),this.clampShader.use().int("source",0).float("low",t).float("high",e),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.nodeBack.end(),this.swap()},t.prototype.multiply=function(t){return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.heatmap.quad),this.gl.vertexAttribPointer(0,4,this.gl.FLOAT,!1,0,0),this.nodeFront.bind(0),this.nodeBack.use(),this.multiplyShader.use().int("source",0).float("value",t),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.nodeBack.end(),this.swap()},t.prototype.blur=function(){return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.heatmap.quad),this.gl.vertexAttribPointer(0,4,this.gl.FLOAT,!1,0,0),this.nodeFront.bind(0),this.nodeBack.use(),this.blurShader.use().int("source",0).vec2("viewport",this.width,this.height),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.nodeBack.end(),this.swap()},t.prototype.swap=function(){var t;return t=this.nodeFront,this.nodeFront=this.nodeBack,this.nodeBack=t},t.prototype.addVertex=function(t,e,n,i,a){return this.vertexBufferData[this.bufferIndex++]=t,this.vertexBufferData[this.bufferIndex++]=e,this.vertexBufferData[this.bufferIndex++]=n,this.vertexBufferData[this.bufferIndex++]=i,this.vertexBufferData[this.bufferIndex++]=a,this.vertexBufferData[this.bufferIndex++]=a,this.vertexBufferData[this.bufferIndex++]=a,this.vertexBufferData[this.bufferIndex++]=a},t.prototype.addPoint=function(t,e,n,i){var a;return null==n&&(n=50),null==i&&(i=.2),this.pointCount>=this.maxPointCount-1&&this.update(),e=this.height-e,a=n/2,this.addVertex(t,e,-a,-a,i),this.addVertex(t,e,+a,-a,i),this.addVertex(t,e,-a,+a,i),this.addVertex(t,e,-a,+a,i),this.addVertex(t,e,+a,-a,i),this.addVertex(t,e,+a,+a,i),this.pointCount+=1},t}(),L=function(){function t(t){var e,n,i,a,r,o,s,l,h,u,c,d;c=null!=t?t:{},this.canvas=c.canvas,this.width=c.width,this.height=c.height,s=c.intensityToAlpha,r=c.gradientTexture,n=c.alphaRange,this.canvas||(this.canvas=document.createElement("canvas"));try{if(this.gl=this.canvas.getContext("experimental-webgl",{depth:!1,antialias:!1}),null===this.gl&&(this.gl=this.canvas.getContext("webgl",{depth:!1,antialias:!1}),null===this.gl))throw"WebGL not supported"}catch(t){throw"WebGL not supported"}null!=window.WebGLDebugUtils&&(console.log("debugging mode"),this.gl=WebGLDebugUtils.makeDebugContext(this.gl,(function(t,e,n){throw WebGLDebugUtils.glEnumToString(t)+" was caused by call to: "+e}))),this.gl.enableVertexAttribArray(0),this.gl.blendFunc(this.gl.ONE,this.gl.ONE),r?(u=this.gradientTexture=new M(this.gl,{channels:"rgba"}).bind(0).setSize(2,2).nearest().clampToEdge(),"string"==typeof r?((o=new Image).onload=function(){return u.bind().upload(o)},o.src=r):r.width>0&&r.height>0?u.upload(r):r.onload=function(){return u.upload(r)},a="uniform sampler2D gradientTexture;\nvec3 getColor(float intensity){\n    return texture2D(gradientTexture, vec2(intensity, 0.0)).rgb;\n}"):(u=null,a="vec3 getColor(float intensity){\n    vec3 blue = vec3(0.0, 0.0, 1.0);\n    vec3 cyan = vec3(0.0, 1.0, 1.0);\n    vec3 green = vec3(0.0, 1.0, 0.0);\n    vec3 yellow = vec3(1.0, 1.0, 0.0);\n    vec3 red = vec3(1.0, 0.0, 0.0);\n\n    vec3 color = (\n        fade(-0.25, 0.25, intensity)*blue +\n        fade(0.0, 0.5, intensity)*cyan +\n        fade(0.25, 0.75, intensity)*green +\n        fade(0.5, 1.0, intensity)*yellow +\n        smoothstep(0.75, 1.0, intensity)*red\n    );\n    return color;\n}"),null==s&&(s=!0),s?(i=(d=null!=n?n:[0,1])[0],e=d[1],l="vec4 alphaFun(vec3 color, float intensity){\n    float alpha = smoothstep("+i.toFixed(8)+", "+e.toFixed(8)+", intensity);\n    return vec4(color*alpha, alpha);\n}"):l="vec4 alphaFun(vec3 color, float intensity){\n    return vec4(color, 1.0);\n}",this.shader=new k(this.gl,{vertex:W,fragment:B+"float linstep(float low, float high, float value){\n    return clamp((value-low)/(high-low), 0.0, 1.0);\n}\n\nfloat fade(float low, float high, float value){\n    float mid = (low+high)*0.5;\n    float range = (high-low)*0.5;\n    float x = 1.0 - clamp(abs(mid-value)/range, 0.0, 1.0);\n    return smoothstep(0.0, 1.0, x);\n}\n\n"+a+"\n"+l+"\n\nvoid main(){\n    float intensity = smoothstep(0.0, 1.0, texture2D(source, texcoord).r);\n    vec3 color = getColor(intensity);\n    gl_FragColor = alphaFun(color, intensity);\n}"}),null==this.width&&(this.width=this.canvas.offsetWidth||2),null==this.height&&(this.height=this.canvas.offsetHeight||2),this.canvas.width=this.width,this.canvas.height=this.height,this.gl.viewport(0,0,this.width,this.height),this.quad=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.quad),h=new Float32Array([-1,-1,0,1,1,-1,0,1,-1,1,0,1,-1,1,0,1,1,-1,0,1,1,1,0,1]),this.gl.bufferData(this.gl.ARRAY_BUFFER,h,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null),this.heights=new I(this,this.gl,this.width,this.height)}return t.prototype.adjustSize=function(){var t,e;if(e=this.canvas.offsetWidth||2,t=this.canvas.offsetHeight||2,this.width!==e||this.height!==t)return this.gl.viewport(0,0,e,t),this.canvas.width=e,this.canvas.height=t,this.width=e,this.height=t,this.heights.resize(this.width,this.height)},t.prototype.display=function(){return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.quad),this.gl.vertexAttribPointer(0,4,this.gl.FLOAT,!1,0,0),this.heights.nodeFront.bind(0),this.gradientTexture&&this.gradientTexture.bind(1),this.shader.use().int("source",0).int("gradientTexture",1),this.gl.drawArrays(this.gl.TRIANGLES,0,6)},t.prototype.update=function(){return this.heights.update()},t.prototype.clear=function(){return this.heights.clear()},t.prototype.clamp=function(t,e){return null==t&&(t=0),null==e&&(e=1),this.heights.clamp(t,e)},t.prototype.multiply=function(t){return null==t&&(t=.95),this.heights.multiply(t)},t.prototype.blur=function(){return this.heights.blur()},t.prototype.addPoint=function(t,e,n,i){return this.heights.addPoint(t,e,n,i)},t.prototype.addPoints=function(t){var e,n,i,a;for(a=[],n=0,i=t.length;n<i;n++)e=t[n],a.push(this.addPoint(e.x,e.y,e.size,e.intensity));return a},t}();var V=.25,j=100,Y={},q={};function Z(t){Y.overlay&&void 0!==t&&(Y.overlay.style.opacity="".concat(t/100))}function K(t){if(Y.canvas&&Y.instance&&Y.overlay){u(Y.overlay,t);var e=document.body.clientWidth*V,n=c(t)*V;Y.canvas.style.width="".concat(e,"px"),Y.canvas.style.height="".concat(n,"px"),Y.instance.adjustSize(e,n)}}function Q(t){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q(t)}var J=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],$=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function tt(t,e,n,i,a,r){if(!(isNaN(r)||r<1)){r|=0;var o=function(t,e,n,i,a){if("string"==typeof t&&(t=document.getElementById(t)),!t||"object"!==Q(t)||!("getContext"in t))throw new TypeError("Expecting canvas with `getContext` method in processCanvasRGB(A) calls!");var r=t.getContext("2d");try{return r.getImageData(e,n,i,a)}catch(t){throw new Error("unable to access image data: "+t)}}(t,e,n,i,a);o=function(t,e,n,i,a,r){for(var o,s=t.data,l=2*r+1,h=i-1,u=a-1,c=r+1,d=c*(c+1)/2,f=new et,g=f,p=1;p<l;p++)g=g.next=new et,p===c&&(o=g);g.next=f;for(var b,v,m=null,y=null,x=J[r],E=$[r],_=0,w=0,T=0;T<a;T++){var A=s[w],R=s[w+1],F=s[w+2],S=c*A,O=c*R,C=c*F,I=d*A,P=d*R,k=d*F;g=f;for(var M=0;M<c;M++)g.r=A,g.g=R,g.b=F,g=g.next;for(var L=0,B=0,N=0,W=1;W<c;W++)b=w+((h<W?h:W)<<2),I+=(g.r=A=s[b])*(v=c-W),P+=(g.g=R=s[b+1])*v,k+=(g.b=F=s[b+2])*v,L+=A,B+=R,N+=F,g=g.next;m=f,y=o;for(var D=0;D<i;D++)s[w]=I*x>>E,s[w+1]=P*x>>E,s[w+2]=k*x>>E,I-=S,P-=O,k-=C,S-=m.r,O-=m.g,C-=m.b,b=_+((b=D+r+1)<h?b:h)<<2,I+=L+=m.r=s[b],P+=B+=m.g=s[b+1],k+=N+=m.b=s[b+2],m=m.next,S+=A=y.r,O+=R=y.g,C+=F=y.b,L-=A,B-=R,N-=F,y=y.next,w+=4;_+=i}for(var U=0;U<i;U++){var G=s[w=U<<2],H=s[w+1],X=s[w+2],z=c*G,V=c*H,j=c*X,Y=d*G,q=d*H,Z=d*X;g=f;for(var K=0;K<c;K++)g.r=G,g.g=H,g.b=X,g=g.next;for(var Q=0,tt=0,nt=0,it=1,at=i;it<=r;it++)w=at+U<<2,Y+=(g.r=G=s[w])*(v=c-it),q+=(g.g=H=s[w+1])*v,Z+=(g.b=X=s[w+2])*v,Q+=G,tt+=H,nt+=X,g=g.next,it<u&&(at+=i);w=U,m=f,y=o;for(var rt=0;rt<a;rt++)s[b=w<<2]=Y*x>>E,s[b+1]=q*x>>E,s[b+2]=Z*x>>E,Y-=z,q-=V,Z-=j,z-=m.r,V-=m.g,j-=m.b,b=U+((b=rt+c)<u?b:u)*i<<2,Y+=Q+=m.r=s[b],q+=tt+=m.g=s[b+1],Z+=nt+=m.b=s[b+2],m=m.next,z+=G=y.r,V+=H=y.g,j+=X=y.b,Q-=G,tt-=H,nt-=X,y=y.next,w+=i}return t}(o,0,0,i,a,r),t.getContext("2d").putImageData(o,e,n)}}var et=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.r=0,this.g=0,this.b=0,this.a=0,this.next=null},nt=function(t,e,n){if(n||2===arguments.length)for(var i,a=0,r=e.length;a<r;a++)!i&&a in e||(i||(i=Array.prototype.slice.call(e,0,a)),i[a]=e[a]);return t.concat(i||Array.prototype.slice.call(e))},it={activeResolution:"desktop",data:{},images:{}},at=["#000000","#00031d","#00052d","#00094f","#000c6a","#000f7f","#0014ac","#0017c6","#001dff","#003dff","#0074ff","#009cff","#00bcff","#00d3ff","#00ebff","#00ffeb","#00ffac","#00ff74","#00ff4d","#2aff00","#62ff00","#91ff00","#b1ff00","#d1ff00","#f8ff00","#ffde00","#ffbe00","#ff9700","#ff7700","#ff5f00","#ff4700","#ff0000"];function rt(t){it.canvas&&void 0!==t&&(it.canvas.style.opacity="".concat(t/100))}function ot(t){if(!t.length)return t;var e=st(t),n=lt(t),i=ht(t)-n,a=t.length,r=t[0]||0,o=t[t.length-1]||0;t=nt(nt(nt([],new Array(10).fill(r),!0),t,!0),new Array(10).fill(o),!0);for(var s=[],l=1;l<t.length-1;++l){var h=t[l],u=st([e,s[l-1]||t[l-1],h,t[l+1]]);s.push(u)}var c=lt(s=s.splice(9,a)),d=ht(s)-c;return s.map((function(t){return(t-c)/d})).map((function(t){return Math.round(t*i)+n}))}function st(t){return t.reduce((function(t,e){return t+e}),0)/t.length}function lt(t){return t.reduce((function(t,e){return Math.min(t,e)}),Number.POSITIVE_INFINITY)}function ht(t){return t.reduce((function(t,e){return Math.max(t,e)}),Number.NEGATIVE_INFINITY)}function ut(t,e){void 0===e&&(e={});var n=document.createElement(t),i=e.id,a=e.className,r=e.style,o=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(t);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(t,i[a])&&(n[i[a]]=t[i[a]])}return n}(e,["id","className","style"]);return"string"==typeof i&&(n.id=i),"string"==typeof a&&(n.className=a),"object"==typeof r&&Object.keys(r).forEach((function(t){n.style[t]=r[t]})),Object.keys(o).forEach((function(t){n[t]=o[t]})),n}var ct=window.lodash;function dt(t,e){if("other"===e)return"#ec82b6";e="".concat(null!=e?e:"");var n=isNaN(Number.parseInt(e))?-1:Number.parseInt(e);switch(t){case"country":return function(t){return{AR:"#75aadb",AU:"#008000",BR:"#2dc52d",CA:"#f71818",CN:"#ff0000",FI:"#2008ff",FR:"#0000ff",DE:"#b97575",GR:"#9292da",IS:"#9494c3",IN:"#ffa500",IT:"#007fff",JP:"#e8f48c",NL:"#ff7f00",NZ:"#993333",NO:"#00008b",PT:"#218000",RU:"#3e3e77",ES:"#ff0000",GB:"#e64444",US:"#ec7777"}[t]}(e);case"device":return function(t){return{desktop:"#11a0d2",console:"#f17b45",mobile:"#ffc65d",tablet:"#7bc8a4",smarttv:"#93648d",wearable:"#4bc0d6",embedded:"#ec82b6"}[t]}(e);case"os":return function(t){return"Mac OS X"===(t="".concat(t))?"#e6e6e6":-1!==t.indexOf("Windows 10")?"#066b96":-1!==t.indexOf("Windows Phone")?"#097cae":-1!==t.indexOf("Windows 7")?"#0a8bc3":-1!==t.indexOf("Windows Vista")?"#049cde":-1!==t.indexOf("Windows XP")?"#35afe4":-1!==t.indexOf("Windows")?"#67c5ef":{"Chromium OS":"#63c7c5","Mac OS":"#c3c3c3",Android:"#97e375",Debian:"#ff7185",Fuchsia:"#d0608a",Linux:"#5e2c80",Mint:"#7aaa65",SUSE:"#84bc91",Ubuntu:"#f28b4a",iOS:"#d6d6d6"}[t]}(e);case"browser":return function(t){return{"Opera Mini":"#ff6060","Opera Mobi":"#ff9090","Samsung Browser":"#93648d",Chrome:"#7bc8a4",Chromium:"#6cbc6d",Edge:"#024b6e",Firefox:"#f28b4a",Mozilla:"#f29f79",Opera:"#f24a4a",Safari:"#ffc65d",Vivaldi:"#ef6dd2"}["".concat(t)]}(e);case"dayOfWeek":return function(t){return["#ec82b6","#f17b45","#ffc65d","#7bc8a4","#4cc3d9","#4c8ad9","#93648d","#ec82b6"][t]}(n);case"hourOfDay":return function(t){return["#003e6b","#034d71","#066b96","#64c8c6","#dbeabf","#e3e075","#faca5c","#f28b4a","#d1618b","#9a4987","#5e2c80","#15205a"][t]}(n);default:return function(t){return["#cb0a0a","#ef4444","#f17b45","#ffb039","#ffc65d","#bfe656","#7bc8a4","#59d1b7","#4cc3d9","#42b0ec","#4a87d5","#5b52f3","#91628b","#753966"][t]}(n)}}var ft,gt=function(){return gt=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},gt.apply(this,arguments)},pt=["#753966","#91628b","#5b52f3","#4a87d5","#42b0ec","#4cc3d9","#59d1b7","#7bc8a4","#bfe656","#ffc65d","#ffb039","#f17b45","#ef4444","#cb0a0a"],bt={};function vt(t,e){var n,i,a;"update-opacity"!==t.type?"render-results"===t.type&&("confetti"===t.mode?t.areResultsLoaded&&(bt.canvas||(bt.overlay=h("div","desktop"),bt.overlay.style.background="#000",bt.canvas=h("canvas","desktop")),ft||(n=x(),ft=function(t){var e={country:{},device:{},os:{},browser:{},dayOfWeek:{},hourOfDay:{},timeToClick:{},windowWidth:{}};return t.forEach((function(t){e.country[t.country]=(e.country[t.country]||0)+t.intensity,e.device[t.device]=(e.device[t.device]||0)+t.intensity,e.os[t.os]=(e.os[t.os]||0)+t.intensity,e.browser[t.browser]=(e.browser[t.browser]||0)+t.intensity,e.dayOfWeek[t.dayOfWeek]=(e.dayOfWeek[t.dayOfWeek]||0)+t.intensity,e.hourOfDay[t.hourOfDay]=(e.hourOfDay[t.hourOfDay]||0)+t.intensity,e.timeToClick[t.timeToClick]=(e.timeToClick[t.timeToClick]||0)+t.intensity,e.windowWidth[t.windowWidth]=(e.windowWidth[t.windowWidth]||0)+t.intensity})),Object.keys(e).reduce((function(t,n){var i;return gt(gt({},t),((i={})[n]=function(t,e){switch(t){case"country":case"device":return yt(t,e);case"os":return n=yt(t,e),i={"Windows 10":"Windows 01","Windows Phone":"Windows 02","Windows 7":"Windows 03","Windows Vista":"Windows 04","Windows XP":"Windows 05","Windows 98":"Windows 06","Windows 95":"Windows 07",Windows:"Windows 08"},a=(0,ct.values)(n).map((function(t){var e=t.key,n=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(i=Object.getOwnPropertySymbols(t);a<i.length;a++)e.indexOf(i[a])<0&&Object.prototype.propertyIsEnumerable.call(t,i[a])&&(n[i[a]]=t[i[a]])}return n}(t,["key"]);return gt(gt({key:e},n),{sorting:i[e]?i[e]:e})})),r=(a=(0,ct.orderBy)(a,"sorting")).map((function(t){return{key:t.key,color:t.color,value:t.value,label:t.label}})),(0,ct.keyBy)(r,"key");case"browser":return function(t){var e=(0,ct.orderBy)((0,ct.values)(t),"key");return(0,ct.keyBy)(e,"key")}(yt(t,e));case"dayOfWeek":case"hourOfDay":case"timeToClick":case"windowWidth":return function(t,e){var n={dayOfWeek:[{label:(0,o._x)("Sunday","text","nelio-ab-testing")},{label:(0,o._x)("Monday","text","nelio-ab-testing")},{label:(0,o._x)("Tuesday","text","nelio-ab-testing")},{label:(0,o._x)("Wednesday","text","nelio-ab-testing")},{label:(0,o._x)("Thursday","text","nelio-ab-testing")},{label:(0,o._x)("Friday","text","nelio-ab-testing")},{label:(0,o._x)("Saturday","text","nelio-ab-testing")}],hourOfDay:[{label:(0,o._x)("12a - 2a","text","nelio-ab-testing")},{label:(0,o._x)("2a - 4a","text","nelio-ab-testing")},{label:(0,o._x)("4a - 6a","text","nelio-ab-testing")},{label:(0,o._x)("6a - 8a","text","nelio-ab-testing")},{label:(0,o._x)("8a - 10a","text","nelio-ab-testing")},{label:(0,o._x)("10a - 12p","text","nelio-ab-testing")},{label:(0,o._x)("12p - 2p","text","nelio-ab-testing")},{label:(0,o._x)("2p - 4p","text","nelio-ab-testing")},{label:(0,o._x)("4p - 6p","text","nelio-ab-testing")},{label:(0,o._x)("6p - 8p","text","nelio-ab-testing")},{label:(0,o._x)("8p - 10p","text","nelio-ab-testing")},{label:(0,o._x)("10p - 12a","text","nelio-ab-testing")}],timeToClick:[{label:(0,o._x)("0 - 2s","text","nelio-ab-testing")},{label:(0,o._x)("2 - 3s","text","nelio-ab-testing")},{label:(0,o._x)("3 - 4s","text","nelio-ab-testing")},{label:(0,o._x)("4 - 5s","text","nelio-ab-testing")},{label:(0,o._x)("5 - 10s","text","nelio-ab-testing")},{label:(0,o._x)("10 - 15s","text","nelio-ab-testing")},{label:(0,o._x)("15 - 20s","text","nelio-ab-testing")},{label:(0,o._x)("20 - 25s","text","nelio-ab-testing")},{label:(0,o._x)("25 - 30s","text","nelio-ab-testing")},{label:(0,o._x)("30 - 60s","text","nelio-ab-testing")},{label:(0,o._x)("1 - 2min","text","nelio-ab-testing")},{label:(0,o._x)("2 - 3min","text","nelio-ab-testing")},{label:(0,o._x)("3 - 5min","text","nelio-ab-testing")},{label:(0,o._x)("+5min","text","nelio-ab-testing")}],windowWidth:[{label:(0,o._x)("< 300 px","text","nelio-ab-testing")},{label:(0,o._x)("300 - 600px","text","nelio-ab-testing")},{label:(0,o._x)("600 - 900px","text","nelio-ab-testing")},{label:(0,o._x)("900 - 1200px","text","nelio-ab-testing")},{label:(0,o._x)("1200 - 1500px","text","nelio-ab-testing")},{label:(0,o._x)("1500 - 1800px","text","nelio-ab-testing")},{label:(0,o._x)("1800 - 2100px","text","nelio-ab-testing")},{label:(0,o._x)("+2100px","text","nelio-ab-testing")}]}[t].map((function(t,n){var i=t.label;return{key:"".concat(n),label:i,value:e[n]||0,color:""}})),i=0;return(0,ct.keyBy)(n.map((function(e){return gt(gt({},e),{color:dt(t,e.key)||pt[i++]})})),"key")}(t,e)}var n,i,a,r}(n,e[n]),i))}),{})}(n),e("nab/data").setPageAttribute("heatmap/confettiFilterOptions",ft)),mt(t.opacity),bt.overlay&&bt.canvas&&(u(bt.overlay,"desktop"),u(bt.canvas,"desktop"),document.body!==bt.canvas.parentNode&&(document.body.appendChild(bt.overlay),document.body.appendChild(bt.canvas))),function(t,e){if(bt.canvas){var n=bt.canvas.getContext("2d");n&&(n.clearRect(0,0,bt.canvas.width,bt.canvas.height),n.lineWidth=1,n.strokeStyle="#000",x().filter((function(n){return function(t,e,n){var i=t[e];return Object.keys(ft[e]||{}).includes("".concat(i))||(i="other"),!n.includes("".concat(i))}(n,t,e)})).forEach((function(e){return function(t,e,n){var i,a;if(e.realCoordinates&&e.realCoordinates.desktop&&(null===(i=e.isVisibleInResolution)||void 0===i?void 0:i.desktop)){var r=e.realCoordinates.desktop,o=r.x,s=r.y,l=ft[n]||{};t.fillStyle=(null===(a=l[e[n]])||void 0===a?void 0:a.color)?l[e[n]].color:dt(n,"other"),t.beginPath(),t.arc(o,s,6,0,2*Math.PI,!0),t.closePath(),t.fill(),t.stroke()}}(n,e,t)})))}}(t.activeFilter,t.disabledFilterOptions)):(document.body===(null===(i=bt.canvas)||void 0===i?void 0:i.parentNode)&&document.body.removeChild(bt.canvas),document.body===(null===(a=bt.overlay)||void 0===a?void 0:a.parentNode)&&document.body.removeChild(bt.overlay))):mt(t.value)}function mt(t){bt.overlay&&void 0!==t&&(bt.overlay.style.opacity="".concat(t/100))}function yt(t,e){var n=(0,ct.orderBy)(Object.keys(e).map((function(t){return{key:t,value:e[t]}})),"value","desc"),i=n.splice(0,14);i=(0,ct.orderBy)(i,"key"),n.length&&i.push({key:"other",value:n.reduce((function(t,e){return t+e.value}),0)});var a=0;return(0,ct.keyBy)(i.map((function(e){var n=e.key,i=e.value;return{key:n,label:xt(t,n),value:"".concat(i),color:dt(t,n)||pt[a++]}})),"key")}function xt(t,e){return"other"===e?(0,o._x)("Other","text","nelio-ab-testing"):"device"===t?e[0].toUpperCase()+e.slice(1):e}var Et="nab/data";function _t(t){if(wt(window.parent)){var e=t.data,n=window.parent.wp.data.dispatch;(function(t,e){switch(t.type){case"reset-heights":!function(t,e){if(X&&O[t])return e(F).setPageAttribute("heatmap/iframeContentHeight",c(t)),void e(F).setPageAttribute("heatmap/resolutionChangeMode","fix-heights");if(S[t])e(F).setPageAttribute("heatmap/resolutionChangeMode","fetch-lazy-load-images");else{if(!S.original){var n=Array.from(document.querySelectorAll(".nab-overlay-element, .nab-overlay-element *")),i=Array.from(document.querySelectorAll("*")).filter((function(t){return!n.includes(t)}));S.original=i.map((function(t){return{el:t,cssHeight:t.style.height,cssMinHeight:t.style.minHeight}}))}S.original.forEach((function(t){var e=t.el,n=t.cssHeight,i=t.cssMinHeight;e.style.height=n,e.style.minHeight=i})),e(F).setPageAttribute("heatmap/resolutionChangeMode","fetch-lazy-load-images")}}(t.activeResolution,e);break;case"fetch-lazy-load-images":!function(t){if(X)t(F).setPageAttribute("heatmap/resolutionChangeMode","calculate-heights-in-double-sized-iframe");else{var e=Array.from(document.querySelectorAll("img[data-src]")).reverse();e.forEach((function(t){var e=t.getAttribute("data-src");e&&t.setAttribute("src",e)}));var n=e.length?500:0;setTimeout((function(){X=!0,t(F).setPageAttribute("heatmap/resolutionChangeMode","calculate-heights-in-double-sized-iframe")}),n)}}(e);break;case"calculate-heights-in-double-sized-iframe":!function(t,e){S[t]?e(F).setPageAttribute("heatmap/resolutionChangeMode","calculate-actual-heights"):(e(F).setPageAttribute("heatmap/iframeContentHeight",50*window.innerHeight),setTimeout((function(){var n=Array.from(document.querySelectorAll(".nab-overlay-element, .nab-overlay-element *")),i=Array.from(document.querySelectorAll("*")).filter((function(t){return!n.includes(t)}));S[t]=i.map((function(t){return{el:t,actualHeight:window.getComputedStyle(t).height,style:{height:t.style.height,maxHeight:t.style.maxHeight}}})),e(F).setPageAttribute("heatmap/resolutionChangeMode","calculate-actual-heights")}),100))}(t.activeResolution,e);break;case"calculate-actual-heights":!function(t,e){if(O[t])return e(F).setPageAttribute("heatmap/iframeContentHeight",c(t)),void e(F).setPageAttribute("heatmap/resolutionChangeMode","fix-heights");e(F).setPageAttribute("heatmap/iframeContentHeight",window.innerHeight/50),setTimeout((function(){var n;null===(n=S[t])||void 0===n||n.forEach((function(t){var e=window.getComputedStyle(t.el).height;t.didHeightChange=t.actualHeight!==e,t.actualHeight=e,t.style.height=t.el.style.height,t.style.maxHeight=t.el.style.maxHeight})),O[t]=!0,e(F).setPageAttribute("heatmap/iframeContentHeight",c(t)),e(F).setPageAttribute("heatmap/resolutionChangeMode","fix-heights")}),100)}(t.activeResolution,e);break;case"fix-heights":!function(t,e){var n;null===(n=S[t])||void 0===n||n.forEach((function(t){var e=t.el,n=t.actualHeight,i=t.didHeightChange;"true"===e.dataset.nabCustomHeights&&(e.style.height="",e.style.minHeight=""),i&&(e.dataset.nabCustomHeights="true",e.style.height=n,e.style.minHeight=n)})),e(F).setPageAttribute("heatmap/iframeContentHeight",c(t)),e(F).setPageAttribute("heatmap/resolutionChangeMode","compute-click-coordinates")}(t.activeResolution,e);break;case"compute-click-coordinates":!function(t,e){E(t)?e(F).setPageAttribute("heatmap/resolutionChangeMode","none"):setTimeout((function(){var n;n=t,!b&&v&&(m[n]||T(n)),e(F).setPageAttribute("heatmap/iframeContentHeight",c(t)),e(F).setPageAttribute("heatmap/resolutionChangeMode","none")}),100)}(t.activeResolution,e);break;case"recompute-click-coordinates":!function(t,e){!b&&v&&(m={desktop:!1,tablet:!1,smartphone:!1},y={desktop:{},tablet:{},smartphone:{}},T(t)),e(F).setPageAttribute("heatmap/resolutionChangeMode","none")}(t.activeResolution,e)}})(e,n),function(t){var e,n,i;"update-opacity"!==t.type?"recompute-click-coordinates"!==t.type?"render-results"===t.type&&("heatmap"===t.mode?t.areResultsLoaded&&(Y.instance||function(t){Y.overlay=h("div",t),Y.overlay.style.background="#000",Y.canvas=h("canvas",t),Y.canvas.style.mixBlendMode="screen",Y.canvas.style.transform="scale(".concat(4..toFixed(3),")"),Y.canvas.style.transformOrigin="0 0";try{Y.instance=(e={canvas:Y.canvas},new L(e))}catch(t){console.error(t)}var e}(t.activeResolution),Z(t.opacity),i=t.activeResolution,Y.canvas&&Y.overlay&&(document.body!==Y.canvas.parentNode?(document.body.appendChild(Y.overlay),document.body.appendChild(Y.canvas),K(i)):K(i)),function(t,e,n){if(Y.instance){var i=function(t,e){if(b)return[];if(!v)return[];if(!m[t]||!v.clicks)return[];var n=d(t,e),i=n.minWidth,a=n.maxWidth;return v.clicks.filter((function(e){var n=e.realCoordinates,r=e.windowWidthInPx;return i<=r&&r<=a&&!!(null==n?void 0:n[t])}))}(e,n);q[e]||function(t,e){if(E(e)&&!q[e]){var n=document.body.clientWidth,i=c(e),a=Math.ceil(n/j),r=Math.ceil(i/j),o=new Array(r*a).fill(0);t.forEach((function(t){if(t.isVisibleInResolution[e]){var n=t.realCoordinates[e];if(n){var i=n.x,r=n.y,s=Math.floor(i/j),l=Math.floor(r/j)*a+s;l<0&&o.length<=l||(o[l]+=t.intensity)}}})),q[e]={columns:a,data:o,height:i,max:Math.max(1,o.reduce((function(t,e){return Math.max(t,e||0)}))),rows:r,width:n}}}(i,e);var a=q[e];if(a){var r=a.max,o=t/100;Y.instance.clear(),i.forEach((function(t){return function(t,e,n){if(Y.instance&&t.isVisibleInResolution[n]){var i=t.realCoordinates[n];if(i){var a=i.x,r=i.y,o=function(t,e){var n=q[e],i=t.realCoordinates[e];if(!n||!i)return 1;var a=i.x,r=i.y,o=n.columns,s=n.data,l=Math.floor(a/j),h=Math.floor(r/j)*o+l;return h<0&&s.length<=h?1:n.data[h]}(t,n),s=(o/e*1.6+.4)/o,l=2+-1/(e-0)*(o-0);Y.instance.addPoint(a*V,r*V,l*j*V,s)}}}(t,r,e)})),Y.instance.update(),Y.instance.multiply(o),Y.instance.update(),Y.instance.display()}}}(t.heatmapIntensity,t.activeResolution,t.resolutions)):(document.body===(null===(e=Y.canvas)||void 0===e?void 0:e.parentNode)&&document.body.removeChild(Y.canvas),document.body===(null===(n=Y.overlay)||void 0===n?void 0:n.parentNode)&&document.body.removeChild(Y.overlay))):q={}:Z(t.value)}(e),function(t){var e,n,i,a,r;"update-opacity"!==t.type?"render-results"===t.type&&("scrollmap"===t.mode?t.areResultsLoaded&&(it.scrolls||(it.scrolls=b?[]:v?v.scrolls:[]),it.canvas||function(t){it.canvas=h("canvas",t),it.canvas.style.opacity="0.75",it.averageFold=h("div",t),it.averageFold.style.display="none",it.averageFold.style.height="auto",it.averageFold.style.borderBottom="2px dashed #262b2d",it.averageFold.style.textAlign="center";var e=ut("span",{style:{fontSize:"18px",margin:"0 auto",borderRadius:"4px",fontWeight:"600",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif',background:"#262b2d",pointerEvents:"none",color:"#eee",display:"inline-block",transform:"translate(-50%, -50%)",position:"absolute",whiteSpace:"nowrap"}});it.averageFold.appendChild(e);var n=ut("span",{className:"nab-data-block",style:{padding:"0 1em"}}),i=ut("span",{className:"dashicons dashicons-image-flip-vertical",style:{verticalAlign:"text-top",marginRight:"5px"}}),a=document.createTextNode((0,o._x)("Average Fold:","text","nelio-ab-testing")+" "),r=ut("output",{id:"nab-average-fold"});e.appendChild(n),n.appendChild(i),n.appendChild(a),n.appendChild(r),it.stats=h("div",t),it.stats.style.height="auto",it.stats.style.borderBottom="2px dashed #262b2d",it.stats.style.opacity="0",it.stats.style.transition="opacity 200ms ease-in-out";var s=ut("span",{style:{fontSize:"18px",left:"1em",borderRadius:"4px",fontWeight:"600",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif',background:"#262b2d",pointerEvents:"none",color:"#eee",display:"inline-block",position:"absolute",transform:"translate(0, -50%)",whiteSpace:"nowrap"}}),l=ut("span",{className:"nab-data-block",style:{padding:"0 1em"}}),u=document.createTextNode((0,o._x)("Popularity:","text","nelio-ab-testing")+" "),c=ut("output",{id:"nab-popularity"});s.appendChild(l),l.appendChild(u),l.appendChild(c),it.statsTracker=h("div",t),it.stats.appendChild(s),it.statsTracker.addEventListener("mouseenter",(function(){it.stats&&(it.stats.style.opacity="1")})),it.statsTracker.addEventListener("mouseleave",(function(){it.stats&&(it.stats.style.opacity="0")})),it.statsTracker.addEventListener("mousemove",(function(t){var e=it.data[it.activeResolution];if(e){var n=e.rows,i=e.maxHits,a=n[Math.floor(t.y/50)],r=Math.round(100*a/i)||0,o=document.getElementById("nab-popularity");o&&it.stats&&(o.textContent="".concat(r.toLocaleString(),"%"),it.stats.style.top="".concat(Math.max(t.y,0),"px"))}}))}(t.activeResolution),it.activeResolution=t.activeResolution,rt(t.opacity),r=t.activeResolution,it.averageFold&&it.stats&&it.canvas&&it.statsTracker&&(it.averageFold.style.width="".concat(document.body.clientWidth,"px"),it.stats.style.width="".concat(document.body.clientWidth,"px"),u(it.canvas,r),u(it.statsTracker,r),document.body!==it.canvas.parentNode&&(document.body.appendChild(it.canvas),document.body.appendChild(it.averageFold),document.body.appendChild(it.stats),document.body.appendChild(it.statsTracker))),function(t,e){if(it.images[t]||function(t,e){it.data[t]||function(t,e){var n,i=window.document.body.clientHeight,a=c(t),r=Math.ceil(a/50),o=new Array(r).fill(0),s=0,l=function(t,e,n){var i=d(e,n),a=i.minWidth,r=i.maxWidth;return t.filter((function(t){var e=t.windowWidth;return a<=e&&e<=r}))}(null!==(n=it.scrolls)&&void 0!==n?n:[],t,e);l.forEach((function(t){var e=t.firstFold,n=t.maxScroll,a=t.sweetSpot,l=t.documentHeight;s+=e,n=Math.round(n/l*i),a=Math.round(a/l*i);for(var h=Math.ceil(n/50),u=Math.min(h,r-1),c=0;c<=u;++c)o[c]=++o[c]||1;var d=Math.floor((a-e/2)/50),f=Math.ceil((a+e/2)/50),g=Math.min(f,r-1);for(c=Math.max(0,d);c<=g;++c)o[c]=++o[c]||1})),it.data[t]={rows:o,maxHits:ht(o),averageFold:!!l.length&&Math.ceil(s/l.length)}}(t,e);var n=it.data[t];if(n){var i=n.rows,a=n.maxHits,r=ut("canvas");r.width=1,r.height=i.length;var o=r.getContext("2d");(function(t){for(var e=t,n=0;n<5;++n)e=ot(e);return e})(i.map((function(t){return Math.floor(t/a*(at.length-1))}))).forEach((function(t,e){o&&it.canvas&&(o.fillStyle=at[t],o.fillRect(0,e,it.canvas.width,1))})),tt(r,0,0,r.width,r.height,2),it.images[t]=r}}(t,e),it.canvas){var n=it.images[t],i=it.canvas.getContext("2d");n&&i&&(it.canvas.width=n.width,it.canvas.height=n.height,i.clearRect(0,0,it.canvas.width,it.canvas.height),i.drawImage(n,0,0)),function(t,e){var n=document.getElementById("nab-average-fold");if(n&&it.averageFold){var i=e[t].height,a=(it.data[t]||{}).averageFold;a?(n.textContent="".concat(a.toLocaleString(),"px"),it.averageFold.style.top="".concat(i,"px"),it.averageFold.style.display="block"):(n.textContent="",it.averageFold.style.display="none")}}(t,e)}}(t.activeResolution,t.resolutions)):(document.body===(null===(e=it.canvas)||void 0===e?void 0:e.parentNode)&&document.body.removeChild(it.canvas),document.body===(null===(n=it.stats)||void 0===n?void 0:n.parentNode)&&document.body.removeChild(it.stats),document.body===(null===(i=it.averageFold)||void 0===i?void 0:i.parentNode)&&document.body.removeChild(it.averageFold),document.body===(null===(a=it.statsTracker)||void 0===a?void 0:a.parentNode)&&document.body.removeChild(it.statsTracker))):rt(t.value)}(e),vt(e,n)}}function wt(t){return!!t.wp.data}i()((function(){var t,e,n,i,a,r;if(wt(window.parent)){var s=(0,window.parent.wp.data.dispatch)(Et).setPageAttribute;s("heatmap/dataStatus",{mode:"script-loaded"});var l=(0,window.parent.wp.data.select)(Et),h=l.getExperiment,u=l.getPageAttribute,c=null!==(t=u("editor/activeExperiment"))&&void 0!==t?t:0,d=null!==(e=u("heatmap/activeAlternative"))&&void 0!==e?e:"",f=h(c);if(f){var p=(null!==(n=f.alternatives)&&void 0!==n?n:[]).map((function(t){return t.id})).indexOf(d);if(-1!==p){var y={awsAuthToken:null!==(i=u("heatmap/awsAuthToken"))&&void 0!==i?i:"",siteId:null!==(a=u("heatmap/siteId"))&&void 0!==a?a:"",timezone:null!==(r=u("heatmap/timezone"))&&void 0!==r?r:"",dispatch:window.parent.wp.data.dispatch};!function(){try{document.body.style.height="auto"}catch(t){}}(),window.addEventListener("message",_t,!1),function(t,e,n){if(!b){b=!0,v=!1,m={desktop:!1,tablet:!1,smartphone:!1};var i=(0,n.dispatch)("nab/data").setPageAttribute;i("heatmap/dataStatus",{mode:"loading"}),Promise.all([_("clicks",t,e,n),_("scrolls",t,e,n)]).then((function(t){var e=t[0],n=t[1];i("heatmap/dataStatus",{mode:"processing"}),b=!1,v={clicks:e,scrolls:n},function(){if(v){var t=(0,o._x)("unknown","text","nelio-ab-testing");v=g(g({},v),{clicks:v.clicks.map((function(e){return g(g({},e),{browser:e.browser||t,country:e.country||t,dayOfWeek:(i=e.dayOfWeek,"".concat(i)),device:e.device||t,hourOfDay:(n=e.hourOfDay,"string"==typeof n&&(n=Number.parseInt(n),isNaN(n)&&(n=0)),"".concat(Math.floor(n/2))),intensity:e.intensity||1,os:e.os||t,timeToClick:A(e.timeToClick),windowWidth:R(e.windowWidth),windowWidthInPx:"number"==typeof e.windowWidth?e.windowWidth:Number.parseInt(e.windowWidth)||0,isVisibleInResolution:{},realCoordinates:{}});var n,i}))})}}(),i("heatmap/dataStatus",{mode:"ready"}),i("heatmap/resolutionChangeMode","reset-heights")})).catch((function(){i("heatmap/dataStatus",{mode:"error",rationale:"promise-failed"})}))}}(f,p,y)}else s("heatmap/dataStatus",{mode:"error",rationale:"alternative-not-found"})}else s("heatmap/dataStatus",{mode:"error",rationale:"experiment-not-found"})}else console.error("Parent window doesnt have expected API. Bye!")}))}();var n=nab="undefined"==typeof nab?{}:nab;for(var i in e)n[i]=e[i];e.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})}();